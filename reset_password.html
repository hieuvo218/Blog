<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="d-flex flex-column min-vh-100">
<div class="container mt-5" style="max-width:400px;">
  <h3 class="text-center mb-4">Reset Password</h3>
  <form id="resetForm">
    <input type="password" class="form-control mb-3" name="password" placeholder="New Password" required>
    <button class="btn btn-success w-100">Reset Password</button>
  </form>
  <div id="resetMsg" class="mt-3 text-center text-muted"></div>
</div>

<script>
const params = new URLSearchParams(window.location.search);
const token = params.get('token');

document.getElementById('resetForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const password = e.target.password.value;

  const res = await fetch('api/reset_password.php', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ token, password })
  });

  const data = await res.json();
  document.getElementById('resetMsg').textContent = data.message;

  if (data.success) {
    e.target.reset();
    setTimeout(() => window.location.href = 'login.html', 2000);
  }
});
</script>
</body>
</html>
