<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Book Detail</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root {
        --primary: #1e5fae;
        --track-bg: #e6e6e6;
        --thumb-size: 24px;
        --track-height: 6px;
    }


    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }

    .book-detail { max-width: 900px; margin: 50px auto; }
    .book-cover { max-width: 300px; border-radius: 10px; }
    .footer {
      background-color: #333;
      color: white;
      padding: 16px 0;
      margin-top: auto;
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      max-width: 1200px;
      margin: auto;
      padding: 0 20px;
    }

    .footer-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .footer-logo {
      width: 36px;
      height: 36px;
    }

    .footer-right img {
      width: 28px;
      height: 28px;
      margin: 5px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .footer-right img:hover {
      transform: scale(1.1);
    }
  </style>
</head>
<body>
  <!-- Navbar placeholder -->
  <div id="navbar-placeholder"></div>

  <div class="container mt-3">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="index.html">Home</a></li>
        <li class="breadcrumb-item">Shopping</li>
        <li class="breadcrumb-item"><a href="product_book.html">Books</a></li>
        <li class="breadcrumb-item active">Book Detail</li>
      </ol>
    </nav>
  </div>

  <div class="container book-detail">
    <div id="bookDetail" class="row mt-4"></div>
  </div>

  <a href="product_book.html" class="btn btn-secondary mt-3">
    <i class="bi bi-arrow-left"></i> Back to Products
  </a>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-left">
        <img src="images/logo.png" alt="Logo" class="footer-logo">
        <span class="fw-bold">MyWebsite</span>
      </div>
      <div class="footer-right">
        <img src="images/icons/fb_icon.png" alt="Facebook">
        <img src="images/icons/linkedin_icon.png" alt="LinkedIn">
        <img src="images/icons/ins_icon.png" alt="Instagram">
      </div>
    </div>
  </footer>


  <script>
    fetch("navbar.html")
        .then(response => response.text())
        .then(html => {
            document.getElementById("navbar-placeholder").innerHTML = html;

            // Run session checker after navbar loads
            const script = document.createElement("script");
            script.src = "js/sessionCheck.js";
            script.onload = () => updateNavbar('product_book.html');
            document.body.appendChild(script);

            // Highlight active link
            const currentPage = window.location.pathname.split("/").pop(); // e.g. product_book.html
            const navLinks = document.querySelectorAll("#navbar-placeholder .nav-link, #navbar-placeholder .dropdown-item");

            console.log(navLinks);
            navLinks.forEach(link => {
                const href = link.getAttribute("href");
                if (href && href === currentPage) link.classList.add("active");
                else link.classList.remove("active");
            });
        })
        .catch(err => console.error("Navbar load failed:", err));

    async function loadBookDetail() {
      const params = new URLSearchParams(window.location.search);
      const id = params.get('id');
      if (!id) {
        document.getElementById('bookDetail').innerHTML = '<p>Book not found.</p>';
        return;
      }

      try {
        const res = await fetch(`api/book_detail.php?id=${id}`);
        const book = await res.json();

        if (!book || !book.id) {
          document.getElementById('bookDetail').innerHTML = '<p>Book not found.</p>';
          return;
        }

        document.getElementById('bookDetail').innerHTML = `
          <div class="col-md-4 text-center">
            <img src="${book.image_url || 'images/default_book.png'}" class="book-cover" alt="${book.title}">
          </div>
          <div class="col-md-8">
            <h2>${book.title}</h2>
            <p><strong>Authors:</strong> ${book.author || 'Unknown'}</p>
            <p><strong>Price:</strong> ${book.price ? book.price + ' VND' : 'Contact'}</p>
            <p><strong>Description:</strong><br>${book.description || 'No description available.'}</p>
            <button class="btn btn-success mt-3"><i class="bi bi-cart"></i> Add to Cart</button>
            <h5 class="mt-4">üìç Store location</h5>
            <iframe
                width="100%"
                height="300"
                style="border:0; border-radius: 10px;"
                loading="lazy"
                allowfullscreen
                referrerpolicy="no-referrer-when-downgrade"
                src="https://www.google.com/maps?q='302C L√Ω Th∆∞·ªùng Ki·ªát, Ph∆∞·ªùng 6, T√¢n B√¨nh, TP.HCM'&output=embed">
            </iframe>
          </div>
        `;
      } catch (err) {
        console.error(err);
        document.getElementById('bookDetail').innerHTML = '<p>Error loading book details.</p>';
      }
    }

    loadBookDetail();

  </script>
</body>
</html>
